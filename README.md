This repository contains a set of scripts to automate the process of
gathering data from malware samples, training a machine learning model
on that data, and plotting its classification accuracy.

0. Make a copy of config-template.ini called config.ini and edit it.

1. Ensure that the "tools" subdirectory has been initialized ("`$ git submodule update --init tools`")

2. Either use `get_samples.py` to download samples or copy them into "all_apks" from another source.

3. `sort_malicious.py` uses andrototal.org to sort them into "malicious_apk" and "benign_apk" folders.

4. `extract_apks.sh` unpacks the .apk files into folders and processes some of the data therein.

4.5. If you want to use system calls, run maline and get that data. Otherwise skip this step.

5. Run one of the following scripts to generate feature vectors:
    * `parse_xml.py` for permissions. "app_permission_vectors.json" is generated
    * `parse_maline_output.py` for syscalls. "app_syscall_vectors.json" is generated
    * `parse_disassembled.py` for API calls. "app_methods_vectors.json" is generated
    * `combine_features.py` for a combination of the top weighted features. "app_feature_vectors.json" is generated

6. Run `$ run_trials.sh app_feature_vectors.json` (or whichever json you want) which runs the `tensorflow_learn.py` script (where the ML happens) a number of times and writes the results to "results.csv".

7. `plot_data.py` plots the data produced by the previous step using matplotlib.

8. You can also run `match_features.py` to see which features were weighted heavily by the model.

Instead of using permissions, you could train the model on the system calls used by the applications at runtime. The data can be gathered using [maline](https://github.com/soarlab/maline) and parsed using `parse_maline_output.py`. Then just change the filename used by `tensorflow_learn.py`.
