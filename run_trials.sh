#!/bin/bash

set -e

rm -f results.csv
echo "n,false_positive,false_negative,accuracy" >> results.csv
for n in 1 5 10 15 20 25 30 35 40 45 50; do
    m=10
    false_positive_sum=0
    false_negative_sum=0
    accuracy_sum=0
    for i in `seq 1 $m`; do
        output=`/usr/local/bin/python3 tensorflow_learn.py $1 $n 2>/dev/null`
        output_arr=(${output//$'\n'/ })
        echo "n: $n false_positive: ${output_arr[0]} false_negative: ${output_arr[1]} accuracy: ${output_arr[2]}"
        false_positive_sum=$(echo "scale=2;$false_positive_sum + ${output_arr[0]}" | bc)
        false_negative_sum=$(echo "scale=2;$false_negative_sum + ${output_arr[1]}" | bc)
        accuracy_sum=$(echo "scale=2;$accuracy_sum + ${output_arr[2]}" | bc)
    done
    false_positive_avg=$(echo "scale=2;$false_positive_sum/$m" | bc)
    false_negative_avg=$(echo "scale=2;$false_negative_sum/$m" | bc)
    accuracy_avg=$(echo "scale=2;$accuracy_sum/$m" | bc)
    echo "$n,$false_positive_avg,$false_negative_avg,$accuracy_avg" >> results.csv
done
